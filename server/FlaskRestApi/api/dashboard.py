import subprocess
import pymongo
from flask import request
from flask_restplus import Resource
from flask_restplus import fields
from api.restplus import api
from api.authorizationHelper import LogIn, CreateThing, GetKey, CreateChannel, ConnectToChannel
from api.Database import Database
from serviceApi import startPubToAllRpi

ns = api.namespace('dashboard')

authorization_input_fields = api.model('resource', {
    'payload': fields.String
})


@ns.route('/')
class Authorization(Resource):
    @api.marshal_with(authorization_input_fields)
    def get(self):
        return {
            "name": "asd"
        }

    @api.expect(authorization_input_fields)
    def post(self):
        appId = "ce5f2a5c-405f-47e0-8550-301468fcc8ff"
        data = request.json
        payload = data.get("payload")
	startPubToAllRpi("info")
        return {
		"response": "ok"
                }

