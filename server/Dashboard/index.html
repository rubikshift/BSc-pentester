<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>Dashboard</title>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
	<script>
		function msg() {
			 $.ajax({
				"url":"http://165.22.121.233:8888/api/dashboard/?jsonp=myCallback",
				"type":"GET",
				"dataType":"json",
				"contentType":"application/json",
				"jsonpCallback":"myCallback",
				"success":function(data){
					var str = data.messages.replace("[","").replace("]","");
					var messages = str.split("'");
					var ext = data.externalIds.replace("[","").replace("]","");
					var externalIds = ext.split("'");
					var messagesContainer = document.getElementById('messages');
					for (index in messages) {
						if(!messages[index].includes(",") && messages[index].length >2){
							messagesContainer.innerHTML += "<div> id:"+externalIds[index]+" message:"+messages[index]+"</div>";
						}
					}
				}               
			})
		}
		
		$( document ).ready(function() {
				 $.ajax({
					"url":"http://165.22.121.233:8888/api/dashboard/active/?jsonp=myCallback",
					"type":"GET",
					"dataType":"json",
					"contentType":"application/json",
					"jsonpCallback":"myCallback",
					"success":function(data){
						var mess = data.messages.replace("[","").replace("]","");
						var messages = mess.split("'");
						
						var messagesContainer = document.getElementById('activeRpi');
						for (index in messages) {
							if(!messages[index].includes(",") && messages[index].length >2){
								messagesContainer.innerHTML += "<div>"+messages[index]+"</div>";
							}
						}
					}               
				})
			}
		);
		
		function send() {
			var payload = document.getElementById("payload").value; 
			var externalId =document.getElementById("extId").value; 
			 $.ajax({
				"url":"http://165.22.121.233:8888/api/dashboard/",
				"type":"POST",
				"dataType":"json",
				"data" : '{"externalId":"'+externalId+'", "messages": "'+payload+'"}',
				"contentType":"application/json",
				"jsonpCallback":"myCallback",
				"success":function(data){
				console.log(data);
				}               
			})
		}
		
	</script>
</head>
<body>
<form>
  <input type="button" value="load all messages" onclick="msg()">
</form>
<form>

  First name:<br>
  <input type="text" name="firstname" id="payload" value="Mickey"> <br>
  RPI External ID:<br>
  <input type="text" name="externalId" id="extId" value="All">
  <br>
<input type="button" value="send" onclick="send()">
</form>
<div id = "messages"><h1>Messages:</h1></div>
<br>
<div id = "activeRpi"><h1>Active Rpi:</h1></div>
</body>