\subsection[Podatność na zatruwanie DNS (Jakub Wyka)]{Podatność na zatruwanie DNS}
\subsubsection[Wykazanie podatności]{Wykazanie podatności}
W rozdziale~\ref{chapter:usbethernet} omawiana była realizacja symulowania działania karty sieciowej.
W ramach tej funkcjonalności powstał scenariusz (rozdział~\ref{sce:phar}) 
zakładający zmianę rekordu DNS. W celu przeprowadzenia testu należy przesłać odpowiednio przygotowaną 
wiadomość do urządzenia wykonującego. 

\begin{lstlisting}[language={},label={lst:ph},caption={Przykładowa wiadomość}]
{
    'deviceType': 'ETHER',
    'name': 'test',
    'idVendor': '0x1d6b',
    'idProduct': '0x0104',
    'serial': 'fedcba9876543210',
    'manufacturer': 'BSC',
    'product': 'BSC',
    'payloads':
    [
        {
            'scenario': 'SPOOFING',
            'params': 
            [
                {
                    'ipAddress': '192.168.1.1',
                    'hostname': 'wp.pl',
                    'duration':'240'
                }
            ]
        }
    ]
}
\end{lstlisting}
Jak już wspomniano w rozdziale ~\ref{chapter:mitmMK} przykładowa konfiguracja z listingu~\ref{lst:ph} 
zawiera podstawowe parametry konfiguracyjne dla tworzonego gadżetu USB. Należy również podać 
nazwę realizowanego scenariusza. W tym przypadku jest to \textit{SPOOFING}.
Za pomocą pola \textit{params} przekazywane są parametry specyficzne 
dla wybranego wcześniej scenariusza. 
Jest to \textit{ipAddress}  który określa adres IP w dodawanym rekordzie DNS, a nazwę 
hosta definiuje pole \textit{hostname}. \textit{Duration} jest parametrem określającym czas 
trwania testu. Powyższe parametry wystarczają aby dodać lokalny wpis DNS na urządzeniu wykonującym 
i przekierować użytkownika systemu do złośliwej witryny. Jeśli podany adres IP odpowiada adresowi 
przypisanemu do interfejsu wlan0 urządzenia wykonującego, użytkownik zostaje przekierowany do dokumentu 
hostowanego przez serwer http na urządzeniu wykonującym. Za pomocą skryptu php wpisane przez niego 
wrażliwe dane zostają zapisane na dysku, a następnie zostają odesłane w raporcie testu.

\subsubsection[Ocena Ryzyka]{Ocena Ryzyka}
\begin{itemize}
    \item Szkody - duże, przekierowanie użytkownika na stronę podszywającą się bez jego 
    wiedzy może przynieść poważne konswekwencje. W szczególności jest to kradzież wrażliwych 
    danych, które mogą zostać wykorzystane m.in. do kradzieży konta na portalu lub dostęp do 
    konta bankowego. Oznaczać to może stratę faktycznych dóbr materialnych przez ofiarę.
    \item Odtwarzalność - średnia, opisana w rozdziale ~\ref{chapter:ormitm}.
    \item Możliwość wykorzystania - średnia, opisana w rozdziale ~\ref{chapter:ormitm}.
    \item Ilość dotkniętych użytkowników - mała, zmiana rekordu DNS dotyczy tylko użytkownika, 
    do którego stacji roboczej podłączone jest urządzenie wykonujące.
    \item Wykrywalność - średnia, opisana w rozdziałach ~\ref{subsec:wykrywalnoscJW} i ~\ref{subsec:wykrpharming}. 
    Użytkownik jest w stanie wykryć symulację ataku, jednak wymaga to od niego podstawowej wiedzy na temat 
    certyfikatów. Ważne jest też zwracanie uwagi na komunikaty systemowe.
\end{itemize}
